doctype html
html
  head
    title Seleccionar Especialidades y Médicos
    link(href="https://cdn.lineicons.com/4.0/lineicons.css", rel="stylesheet")
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css", rel="stylesheet")
    link(rel="stylesheet", href="css/styles.css")
    script(src="/js/frontMain.js") // Incluyendo el archivo JS
  body
    .container-fluid(style="background-image: url('images/background_modulos.png'); background-size: cover; background-attachment: fixed; min-height: 100vh;")
      .row
        .col-md-1
          include sidebar.pug

        .col-md-9.mx-auto
          .main.p-3
            h1.text-center Seleccionar Especialidad y Médico
            
            //- Select para Especialidades
            .mb-4
              label(for="especialidad", class="form-label") Seleccionar Especialidad:
              select#especialidad.form-select(name="especialidad")
                option(value="") Selecciona una especialidad
                each especialidad in especialidades
                  option(value=especialidad.id_especialidad) #{especialidad.nombre}

            //- Select para Médicos (inicialmente vacío)
            .mb-4
              label(for="medico", class="form-label") Seleccionar Médico:
              select#medico.form-select(name="medico")
                option(value="") Selecciona un médico
                each medico in medicos
                  option(value=medico.matricula_medico) #{medico.apellido + " " + medico.nombre}

            //- Input de fecha
            .mb-4
              label(for="fechaCalendario", class="form-label") Selecciona una fecha:
              input(type="date" id="fechaCalendario" class="form-control" value=fechaActual)

            // Contenedor donde se mostrarán los resultados
            h1.text-center Turnos para la fecha seleccionada
            div#resultadosContainer
              if turnos.length > 0
                ul#turnosList.list-group
                  each turno in turnos
                    li.list-group-item(data-id=turno.numero_turno)
                      | ID del turno: #{turno.numero_turno}, 
                      | Fecha: #{turno.fecha}, 
                      | Hora: #{turno.hora}, 
                      | Motivo: #{turno.motivo_consulta}, 
                      | Paciente: #{turno.dni_paciente}
              else
                p.text-center No se encontraron turnos para la fecha seleccionada.

            // Pasamos los médicos y especialidades a una variable global accesible desde JavaScript
            script.
              window.medicos = !{JSON.stringify(medicos)}; // Pasar médicos al JS
              window.medicoEspecialidad = !{JSON.stringify(medicoEspecialidad)}; // Pasar relaciones de médicos y especialidades al JS
              window.turnosIniciales = !{JSON.stringify(turnos)}; // Pasar los turnos iniciales al JS (opcional si lo necesitas en front-end)

    //- Incluyendo el archivo JS para manejar el sidebar
    script(src='/js/')
